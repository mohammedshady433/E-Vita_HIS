<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="E_Vita.Views.LabImages"
             Title="Lab Images">

    <ContentPage.Background>
        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#4B0082" Offset="0.0"/>
            <GradientStop Color="#2d003d" Offset="1.0"/>
        </LinearGradientBrush>
    </ContentPage.Background>

    <VerticalStackLayout Padding="0,30,0,0" Spacing="0">
        <!-- Top Bar -->
        <Grid HeightRequest="80" BackgroundColor="#4B0082" VerticalOptions="Start">
            <Label Text="Lab Images"
                   HorizontalOptions="Center"
                   VerticalOptions="Center"
                   TextColor="White"
                   FontSize="32"
                   FontAttributes="Bold"
                   FontFamily="Qatar2022 Arabic"/>
        </Grid>

        <!-- Main Card -->
        <Frame Margin="24,24,24,0"
               Padding="24"
               BackgroundColor="#fff"
               CornerRadius="18"
               HasShadow="True"
               VerticalOptions="FillAndExpand"
               HorizontalOptions="FillAndExpand">
            <VerticalStackLayout Spacing="24" VerticalOptions="FillAndExpand">

                <!-- Search and Upload Controls -->
                <Grid ColumnDefinitions="*,Auto,Auto"
                      RowDefinitions="Auto"
                      VerticalOptions="Center"
                      HorizontalOptions="Center"
                      Padding="0"
                      Margin="0">
                    <Entry x:Name="PatientIDEntry"
                           Grid.Column="0"
                           Placeholder="Enter Patient ID"
                           WidthRequest="220"
                           HeightRequest="44"
                           BackgroundColor="#f3f3f3"
                           TextColor="#4B0082"
                           PlaceholderColor="#b0a7c7"
                           FontSize="18"
                           Margin="0,0,12,0"
                           Keyboard="Numeric"
                           VerticalOptions="Center"/>
                    <Button Grid.Column="1"
                            Text="Search"
                            FontSize="18"
                            BackgroundColor="#4B0082"
                            TextColor="White"
                            CornerRadius="8"
                            HeightRequest="44"
                            WidthRequest="100"
                            Margin="0,0,12,0"
                            Clicked="OnSearchClicked"/>
                    <Button Grid.Column="2"
                            Text="+ Upload New Image"
                            FontSize="18"
                            BackgroundColor="#891739"
                            TextColor="White"
                            CornerRadius="8"
                            HeightRequest="44"
                            Clicked="Upload"/>
                </Grid>

                <!-- Images Section Header -->
                <Label Text="Patient Lab Images"
                       FontSize="22"
                       FontAttributes="Bold"
                       TextColor="#4B0082"
                       Margin="0,0,0,8"
                       HorizontalOptions="Center"/>

                <!-- Images CollectionView -->
                <!-- Make sure to set BindingContext and Images property in code-behind or ViewModel -->
                <CollectionView x:Name="ImagesCollectionView"
                                ItemsSource="{Binding Images}"
                                VerticalOptions="FillAndExpand"
                                HorizontalOptions="FillAndExpand"
                                Margin="0">
                    <CollectionView.ItemsLayout>
                        <GridItemsLayout Orientation="Vertical" Span="3"/>
                    </CollectionView.ItemsLayout>
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Frame Padding="6" HasShadow="False" BackgroundColor="Transparent">
                                <Image Source="{Binding}" 
                                       Aspect="AspectFill"
                                       HeightRequest="120"
                                       WidthRequest="120"
                                       VerticalOptions="FillAndExpand"
                                       HorizontalOptions="FillAndExpand"
                                       Margin="4"/>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>
        </Frame>
    </VerticalStackLayout>
</ContentPage>